<IfModule mod_rewrite.c>
  RewriteEngine On
  
  # 0. Proxy API to Node server (requires mod_proxy & Node on :3001)
  RewriteRule ^api$ http://127.0.0.1:3001/api [P,L]
  RewriteRule ^api/(.*)$ http://127.0.0.1:3001/api/$1 [P,L]
  
  # 1. Root request ko dist/index.html par bhejein
  RewriteRule ^$ dist/index.html [L]
  
  # 2. Agar koi file dist folder ke andar majood hai (jaise assets), to wahan se uthayein
  RewriteCond %{REQUEST_URI} !^/dist/
  RewriteCond %{DOCUMENT_ROOT}/dist%{REQUEST_URI} -f
  RewriteRule ^(.*)$ dist/$1 [L]
  
  # 3. SPA Routing: Agar URL koi asli file nahi hai, to dist/index.html load karein (React routing ke liye)
  # Lekin .xml aur .txt files ko exclude karein taake wo home page par redirect na hon
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_URI} !\.xml$
  RewriteCond %{REQUEST_URI} !\.txt$
  # 4. Exclude API from SPA rewrite (for backend to proxy/handle /api requests)
  RewriteCond %{REQUEST_URI} !^/api/
  RewriteRule ^ dist/index.html [L]
</IfModule>
